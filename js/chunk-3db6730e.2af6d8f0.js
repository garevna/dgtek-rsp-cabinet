(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3db6730e"],{"80db":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",[e.showServices?s("Services",{attrs:{opened:e.showServices},on:{"update:opened":function(t){e.showServices=t}}}):s("v-card",{staticClass:"transparent mx-auto",attrs:{flat:""}},[s("v-row",{staticClass:"mb-4",attrs:{justify:"center"}},[s("h5",[s("small",[e._v(e._s(e.address))])])]),s("v-simple-table",{staticClass:"my-7",scopedSlots:e._u([{key:"default",fn:function(){return[s("thead",[s("tr",[s("th"),s("th",{staticClass:"text-left"},[e._v(" Service name ")]),s("th",{staticClass:"text-center"},[e._v(" Service status ")]),s("th",{staticClass:"text-center"},[e._v(" Status modified ")]),s("th",{staticClass:"text-center"},[e._v(" History ")])])]),s("tbody",e._l(e.schema,(function(t){return s("tr",{key:t.serviceId},[s("td",[s("v-btn",{attrs:{icon:""},on:{click:function(s){return e.disconnect(t)}}},[s("v-icon",{attrs:{color:"primary"}},[e._v("mdi-delete")])],1)],1),s("td",[e._v(e._s(t.serviceName))]),s("td",[s("v-btn",{attrs:{text:"",color:"primary",disabled:!t.modified&&"Not connected"!==t.serviceStatus},on:{click:function(s){return e.sendActivationRequest(t)}}},[e._v(" "+e._s(t.serviceStatus)+" ")])],1),s("td",[e._v(e._s(t.serviceStatusModified))]),s("td")])})),0)]},proxy:!0}],null,!1,3313826722)}),s("v-row",{staticClass:"mt-12 mb-4"},[s("v-btn",{staticClass:"mr-2",attrs:{outlined:"",color:"buttons"},on:{click:e.selectService}},[e._v(" Assign new service ")]),s("v-spacer"),s("v-btn",{staticClass:"buttons",attrs:{dark:""},on:{click:e.updateCustomerServices}},[e._v(" Update/save details ")])],1)],1),e.dialog?s("ServiceDeliveryUpdate",{attrs:{dialog:e.dialog,serviceData:e.selected,address:e.address,customerId:e.customerId},on:{"update:dialog":function(t){e.dialog=t},"update:serviceData":function(t){e.selected=t},"update:service-data":function(t){e.selected=t}}}):e._e()],1)},c=[],r=(s("7db0"),s("c740"),s("4160"),s("d81d"),s("fb6a"),s("a434"),s("b0c0"),s("d3b7"),s("159b"),s("b85c")),o=s("ade3"),n=s("ce96"),a=s("eb8b"),d=function(){this.$root.$emit("open-error-popup",{errorType:"Assign service to customer",errorMessage:"Attempt to duplicate service"})},v={name:"CustomerServices",components:{Services:a["d"],ServiceDeliveryUpdate:function(){return s.e("service-delivery-update").then(s.bind(null,"246c"))}},props:["services","address","update","customerId"],data:function(){return{customerServices:[],schema:[],details:{},showServices:!1,dialog:!1,selected:null,submit:!1}},watch:{selected:{deep:!0,handler:function(e){console.log("SELECTED SERVICE:\n",e);var t=this.schema.findIndex((function(t){return t.serviceId===e.serviceId}));this.schema.splice(t,1,Object.assign({},this.schema[t],{serviceStatus:e.serviceStatus,serviceStatusModified:e.serviceStatusModified}))}},showServices:function(e,t){if(console.log("SHOW SERVICES: ",t,"--\x3e",e),t&&!e){if(console.log(Object(n["f"])()),!Object(n["f"])())return;this.assignNewService()}}},methods:{showError:d,getServiceDetails:function(e){console.log("SERVICE DATA:\n",e);var t=e.serviceName,s=e._id,i=this.services.find((function(e){return e.id===s}));console.log(i),i&&this.schema.push({serviceId:s,serviceName:t,serviceStatus:i.status,serviceStatusModified:new Date(i.modified).toISOString().slice(0,10)})},assignNewService:function(){console.log(Object(n["f"])());var e=Object(n["f"])(),t=e.serviceId,s=e.serviceName,i=e.serviceSpeed,c=e.servicePlan,r=e.serviceTerm;if(this.services.find((function(e){return e.id===t})))return this.showError();this.customerServices.push({id:t,modified:Date.now(),status:"Not connected",log:Object(o["a"])({},Date.now(),"Not connected")}),this.schema.push({serviceId:t,serviceStatusModified:(new Date).toISOString().slice(0,10),serviceName:s,serviceSpeed:i,serviceStatus:"Not connected",servicePlan:c,serviceTerm:r,modified:!0})},selectService:function(){Object(n["g"])("set"),this.showServices=!0},disconnect:function(e){console.log("disconnect",e)},sendActivationRequest:function(e){console.log(e),"Not connected"===e.serviceStatus&&(this.selectedService=this.customerServices.find((function(t){return t.id===e.serviceId})),this.selected=e,console.log("SELECTED SERVICE:\n",this.selected),this.dialog=!0)},updateCustomerServices:function(){console.log(this.customerServices),this.__updateCustomerServices(this.customerId,this.customerServices),this.schema.forEach((function(e){e.modified=!1}))}},beforeDestroy:function(){this.$root.$off("service-details-received",this.getServiceDetails),this.$root.$off("customer-created",this.close)},mounted:function(){console.log(this.services),this.customerServices=this.services.map((function(e){return{id:e.id,status:e.status,modified:e.modified,log:e.log}})),this.$emit("update:services",this.customerServices),console.log(this.services),this.$root.$on("service-details-received",this.getServiceDetails),this.$root.$on("service-selected",this.assignNewService);var e,t=Object(r["a"])(this.services);try{for(t.s();!(e=t.n()).done;){var s=e.value;console.log(s.id),s.name&&delete s.name,this.__getServiceById(s.id)}}catch(i){t.e(i)}finally{t.f()}}},u=v,l=(s("c1bd"),s("2877")),f=s("6544"),h=s.n(f),m=s("8336"),S=s("b0af"),p=s("a523"),b=s("132d"),g=s("0fd9"),w=s("1f4f"),_=s("2fa4"),C=Object(l["a"])(u,i,c,!1,null,null,null);t["default"]=C.exports;h()(C,{VBtn:m["a"],VCard:S["a"],VContainer:p["a"],VIcon:b["a"],VRow:g["a"],VSimpleTable:w["a"],VSpacer:_["a"]})},"902e":function(e,t,s){},c1bd:function(e,t,s){"use strict";s("902e")}}]);
//# sourceMappingURL=chunk-3db6730e.2af6d8f0.js.map