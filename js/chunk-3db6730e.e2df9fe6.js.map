{"version":3,"sources":["webpack:///./src/components/customers/CustomerServices.vue?5ffa","webpack:///src/components/customers/CustomerServices.vue","webpack:///./src/components/customers/CustomerServices.vue?1117","webpack:///./src/components/customers/CustomerServices.vue?337f","webpack:///./src/components/customers/CustomerServices.vue?3981"],"names":["render","_vm","this","_h","$createElement","_c","_self","showServices","attrs","on","$event","staticClass","_v","_s","address","scopedSlots","_u","key","fn","_l","item","serviceId","disconnect","serviceName","modified","serviceStatus","sendActivationRequest","serviceStatusModified","proxy","selectService","updateCustomerServices","dialog","selected","customerId","_e","staticRenderFns","$root","$emit","errorType","errorMessage","name","components","Services","ServiceDeliveryUpdate","props","data","watch","deep","handler","schema","splice","index","Object","assign","service","oldVal","newVal","assignNewService","methods","showError","getServiceDetails","push","status","Date","toISOString","slice","services","find","customerServices","id","now","log","serviceSpeed","servicePlan","serviceTerm","console","selectedService","__updateCustomerServices","forEach","beforeDestroy","$off","close","mounted","map","$on","component","VBtn","VCard","VContainer","VIcon","VRow","VSimpleTable","VSpacer"],"mappings":"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","file":"js/chunk-3db6730e.e2df9fe6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[(!_vm.showServices)?_c('v-card',{staticClass:\"transparent mx-auto\",attrs:{\"flat\":\"\"}},[_c('v-row',{staticClass:\"mb-4\",attrs:{\"justify\":\"center\"}},[_c('h5',[_c('small',[_vm._v(_vm._s(_vm.address))])])]),_c('v-simple-table',{staticClass:\"my-7\",scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('thead',[_c('tr',[_c('th'),_c('th',{staticClass:\"text-left\"},[_vm._v(\" Service name \")]),_c('th',{staticClass:\"text-center\"},[_vm._v(\" Service status \")]),_c('th',{staticClass:\"text-center\"},[_vm._v(\" Status modified \")]),_c('th',{staticClass:\"text-center\"},[_vm._v(\" History \")])])]),_c('tbody',_vm._l((_vm.schema),function(item){return _c('tr',{key:item.serviceId},[_c('td',[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.disconnect(item)}}},[_c('v-icon',{attrs:{\"color\":\"primary\"}},[_vm._v(\"mdi-delete\")])],1)],1),_c('td',[_vm._v(_vm._s(item.serviceName))]),_c('td',[_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"primary\",\"disabled\":item.modified || item.serviceStatus !== 'Not connected'},on:{\"click\":function($event){return _vm.sendActivationRequest(item)}}},[_vm._v(\" \"+_vm._s(item.serviceStatus)+\" \")])],1),_c('td',[_vm._v(_vm._s(item.serviceStatusModified))]),_c('td')])}),0)]},proxy:true}],null,false,3101793443)}),_c('v-row',{staticClass:\"mt-12 mb-4\"},[_c('v-btn',{staticClass:\"mr-2\",attrs:{\"outlined\":\"\",\"color\":\"buttons\"},on:{\"click\":_vm.selectService}},[_vm._v(\" Assign new service \")]),_c('v-spacer'),_c('v-btn',{staticClass:\"buttons\",attrs:{\"dark\":\"\"},on:{\"click\":_vm.updateCustomerServices}},[_vm._v(\" Update/save details \")])],1)],1):_c('Services',{attrs:{\"opened\":_vm.showServices},on:{\"update:opened\":function($event){_vm.showServices=$event}}}),(_vm.dialog)?_c('ServiceDeliveryUpdate',{attrs:{\"dialog\":_vm.dialog,\"serviceData\":_vm.selected,\"address\":_vm.address,\"customerId\":_vm.customerId},on:{\"update:dialog\":function($event){_vm.dialog=$event},\"update:serviceData\":function($event){_vm.selected=$event},\"update:service-data\":function($event){_vm.selected=$event}}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container>\n    <v-card flat class=\"transparent mx-auto\" v-if=\"!showServices\">\n\n      <v-row justify=\"center\" class=\"mb-4\">\n        <h5><small>{{ address }}</small></h5>\n      </v-row>\n\n      <v-simple-table class=\"my-7\">\n        <template v-slot:default>\n          <thead>\n            <tr>\n              <th></th>\n              <th class=\"text-left\">\n                Service name\n              </th>\n              <th class=\"text-center\">\n                Service status\n              </th>\n              <th class=\"text-center\">\n                Status modified\n              </th>\n              <th class=\"text-center\">\n                History\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr\n              v-for=\"item of schema\"\n              :key=\"item.serviceId\"\n            >\n              <td>\n                <v-btn icon @click=\"disconnect(item)\">\n                  <v-icon color=\"primary\">mdi-delete</v-icon>\n                </v-btn>\n              </td>\n              <td>{{ item.serviceName }}</td>\n              <td>\n                <v-btn text color=\"primary\" @click=\"sendActivationRequest(item)\" :disabled=\"item.modified || item.serviceStatus !== 'Not connected'\">\n                  {{ item.serviceStatus }}\n                </v-btn>\n              </td>\n              <td>{{ item.serviceStatusModified }}</td>\n              <td>\n\n              </td>\n            </tr>\n          </tbody>\n        </template>\n      </v-simple-table>\n\n      <v-row class=\"mt-12 mb-4\">\n        <v-btn outlined color=\"buttons\" class=\"mr-2\" @click=\"selectService\">\n          Assign new service\n        </v-btn>\n        <v-spacer />\n        <v-btn dark class=\"buttons\" @click=\"updateCustomerServices\">\n          Update/save details\n        </v-btn>\n      </v-row>\n    </v-card>\n\n    <Services v-else :opened.sync=\"showServices\" />\n    <ServiceDeliveryUpdate\n      v-if=\"dialog\"\n      :dialog.sync=\"dialog\"\n      :serviceData.sync=\"selected\"\n      :address=\"address\"\n      :customerId=\"customerId\"\n    />\n  </v-container>\n</template>\n\n<script>\n\nimport { serviceHandler, showServiceSelectHandler } from '@/helpers'\nimport { Services } from '@/components/dashboard'\n\nconst showError = function () {\n  this.$root.$emit('open-error-popup', {\n    errorType: 'Assign service to customer',\n    errorMessage: 'Attempt to duplicate service'\n  })\n}\n\nexport default {\n  name: 'CustomerServices',\n\n  components: {\n    Services,\n    ServiceDeliveryUpdate: () => import(/* webpackChunkName: 'service-delivery-update' */ '@/components/customers/ServiceDeliveryUpdate.vue')\n  },\n\n  props: ['services', 'address', 'update', 'customerId'],\n\n  data: () => ({\n    customerServices: [],\n    schema: [],\n    details: {},\n    showServices: false,\n    dialog: false,\n    selected: null,\n    submit: false\n  }),\n\n  watch: {\n    selected: {\n      deep: true,\n      handler (service) {\n        const index = this.schema.findIndex(item => item.serviceId === service.serviceId)\n        this.schema.splice(index, 1, Object.assign({}, this.schema[index], {\n          serviceStatus: service.serviceStatus,\n          serviceStatusModified: service.serviceStatusModified\n        }))\n      }\n    },\n    showServices (newVal, oldVal) {\n      if (oldVal && !newVal) {\n        if (!serviceHandler()) return\n        this.assignNewService()\n      }\n    }\n  },\n\n  methods: {\n    showError: showError,\n    getServiceDetails (data) {\n      const { serviceName, _id: serviceId } = data\n\n      const service = this.services.find(item => item.id === serviceId)\n\n      if (!service) return\n      this.schema.push({\n        serviceId,\n        serviceName,\n        serviceStatus: service.status,\n        serviceStatusModified: new Date(service.modified).toISOString().slice(0, 10)\n      })\n    },\n\n    assignNewService () {\n      const {\n        serviceId,\n        serviceName,\n        serviceSpeed,\n        servicePlan,\n        serviceTerm\n      } = serviceHandler()\n\n      if (this.services.find(service => service.id === serviceId)) return this.showError()\n\n      this.customerServices.push({\n        id: serviceId,\n        modified: Date.now(),\n        status: 'Not connected',\n        log: {\n          [Date.now()]: 'Not connected'\n        }\n      })\n\n      this.schema.push({\n        serviceId,\n        serviceStatusModified: (new Date()).toISOString().slice(0, 10),\n        serviceName,\n        serviceSpeed,\n        serviceStatus: 'Not connected',\n        servicePlan,\n        serviceTerm,\n        modified: true\n      })\n    },\n\n    selectService () {\n      showServiceSelectHandler('set')\n      this.showServices = true\n    },\n\n    disconnect (service) {\n      console.log('disconnect', service)\n    },\n\n    sendActivationRequest (item) {\n      if (item.serviceStatus !== 'Not connected') return\n\n      this.selectedService = this.customerServices.find(service => service.id === item.serviceId)\n      this.selected = item\n      this.dialog = true\n    },\n\n    updateCustomerServices () {\n      this.__updateCustomerServices(this.customerId, this.customerServices)\n      this.schema.forEach((item) => { item.modified = false })\n    }\n  },\n\n  beforeDestroy () {\n    this.$root.$off('service-details-received', this.getServiceDetails)\n    this.$root.$off('customer-created', this.close)\n  },\n\n  mounted () {\n    this.customerServices = this.services.map(item => ({\n      id: item.id,\n      status: item.status,\n      modified: item.modified,\n      log: item.log\n    }))\n\n    this.$emit('update:services', this.customerServices)\n\n    this.$root.$on('service-details-received', this.getServiceDetails)\n    this.$root.$on('service-selected', this.assignNewService)\n    for (const service of this.services) {\n      if (service.name) {\n        delete service.name\n      }\n      this.__getServiceById(service.id)\n    }\n  }\n}\n\n</script>\n\n<style>\n.theme--light.v-btn.v-btn--disabled {\n  color: #888 !important;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CustomerServices.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CustomerServices.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CustomerServices.vue?vue&type=template&id=65f3d0f7&\"\nimport script from \"./CustomerServices.vue?vue&type=script&lang=js&\"\nexport * from \"./CustomerServices.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CustomerServices.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCard,VContainer,VIcon,VRow,VSimpleTable,VSpacer})\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CustomerServices.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}