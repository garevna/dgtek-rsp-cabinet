{"version":3,"sources":["webpack:///./src/components/customers/CustomerDetails.vue?ac20","webpack:///src/components/customers/CustomerDetails.vue","webpack:///./src/components/customers/CustomerDetails.vue?825d","webpack:///./src/components/customers/CustomerDetails.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","staticStyle","on","$event","$emit","_v","customer","buildingId","buildingPostCode","_e","buildingData","staticRenderFns","name","components","EditCustomerDetails","EditBuildingDetails","props","data","watch","Object","assign","methods","getBuildingEventHandler","console","log","_id","buildingAddress","buildingAddressComponents","addressComponents","buildingManagement","JSON","parse","stringify","management","buildingOwner","owner","buildingStatus","status","ready","getCustomerEventHandler","result","__getBuildingById","assignNewService","createNewCustomer","address","postCode","uniqueCode","beforeDestroy","$root","$off","mounted","customerId","initialAddressData","$on","__getCustomerData","warn","component","VBtn","VCard","VIcon","VRow","VSpacer","VToolbar"],"mappings":"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","file":"js/chunk-2d21f31a.ffd05d88.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{staticClass:\"transparent mx-auto\",attrs:{\"flat\":\"\",\"width\":\"960\"}},[_c('v-toolbar',{staticClass:\"transparent\",staticStyle:{\"box-shadow\":\"none\"}},[_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"large\":\"\"},on:{\"click\":function($event){return _vm.$emit('update:dialog', false)}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1),(_vm.ready)?_c('EditCustomerDetails',{attrs:{\"initialCustomer\":_vm.customer,\"buildingId\":_vm.buildingId,\"buildingPostCode\":_vm.buildingPostCode},on:{\"update:initialCustomer\":function($event){_vm.customer=$event},\"update:initial-customer\":function($event){_vm.customer=$event},\"update:buildingId\":function($event){_vm.buildingId=$event},\"update:building-id\":function($event){_vm.buildingId=$event}}}):_vm._e(),(_vm.ready)?_c('EditBuildingDetails',{attrs:{\"buildingData\":_vm.buildingData,\"buildingId\":_vm.buildingId,\"postCode\":_vm.buildingPostCode},on:{\"update:buildingId\":function($event){_vm.buildingId=$event},\"update:building-id\":function($event){_vm.buildingId=$event},\"update:postCode\":function($event){_vm.buildingPostCode=$event},\"update:post-code\":function($event){_vm.buildingPostCode=$event}}}):_vm._e(),_c('v-row',{staticClass:\"my-12\",attrs:{\"justify\":\"center\"}},[_c('v-btn',{attrs:{\"outlined\":\"\",\"text\":\"\",\"color\":\"buttons\"},on:{\"click\":function($event){return _vm.$emit('update:dialog', false)}}},[_vm._v(\"Exit\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat class=\"transparent mx-auto\" width=\"960\">\n    <v-toolbar class=\"transparent\" style=\"box-shadow: none\">\n      <v-spacer />\n      <v-btn icon large @click=\"$emit('update:dialog', false)\">\n        <v-icon>mdi-close</v-icon>\n      </v-btn>\n    </v-toolbar>\n    <EditCustomerDetails\n      v-if=\"ready\"\n      :initialCustomer.sync=\"customer\"\n      :buildingId.sync=\"buildingId\"\n      :buildingPostCode=\"buildingPostCode\"\n    />\n    <EditBuildingDetails\n      v-if=\"ready\"\n      :buildingData=\"buildingData\"\n      :buildingId.sync=\"buildingId\"\n      :postCode.sync=\"buildingPostCode\"\n    />\n    <v-row justify=\"center\" class=\"my-12\">\n      <v-btn outlined text color=\"buttons\" @click=\"$emit('update:dialog', false)\">Exit</v-btn>\n    </v-row>\n  </v-card>\n</template>\n\n<script>\n\nimport { newCustomer } from '@/configs'\nimport { getBuildingUniqueCode, normalizeAddress } from '@/helpers'\n\nexport default {\n  name: 'CustomerDetails',\n  components: {\n    EditCustomerDetails: () => import('@/components/customers/EditCustomerDetails.vue'),\n    EditBuildingDetails: () => import('@/components/customers/EditBuildingDetails.vue')\n  },\n  props: ['customerId', 'initialAddressData', 'dialog'],\n  data: () => ({\n    ready: false,\n    customer: null,\n    buildingData: null,\n    buildingId: null,\n    buildingPostCode: null\n  }),\n  watch: {\n    buildingId (value) {\n      Object.assign(this.customer, { buildingId: value })\n    },\n    buildingPostCode (value) {\n      Object.assign(this.customer, { postCode: value })\n    }\n  },\n  methods: {\n    getBuildingEventHandler (data) {\n      console.log('CUSTOMER DETAILS COMPONENT HAS RECEIVED THE BUILDING DATA: ', data)\n      this.buildingData = {\n        buildingId: data._id,\n        buildingAddress: normalizeAddress(data.address),\n        buildingAddressComponents: data.addressComponents,\n        buildingManagement: JSON.parse(JSON.stringify(data.management)),\n        buildingOwner: JSON.parse(JSON.stringify(data.owner)),\n        buildingStatus: data.status\n      }\n      this.ready = true\n      console.log('BUILDING DATA:\\n', this.buildingData)\n    },\n    getCustomerEventHandler (data) {\n      console.log('CUSTOMER DATA RECEIVED:\\n', data)\n      this.customer = data.result\n      const { buildingId } = data.result\n\n      if (buildingId) return this.__getBuildingById(buildingId)\n    },\n\n    // getServices (data) {\n    //   console.log('SERVICES:\\n', data)\n    // },\n\n    assignNewService () {\n      //\n    },\n    createNewCustomer () {\n      console.log('CREATE NEW CUSTOMER')\n      const {\n        buildingAddress,\n        buildingAddressComponents,\n        buildingId,\n        buildingManagement,\n        buildingOwner,\n        buildingStatus\n      } = this.initialAddressData\n\n      console.log(buildingAddress)\n      console.log(buildingAddressComponents)\n\n      this.customer = JSON.parse(JSON.stringify(newCustomer))\n\n      this.customer.address = normalizeAddress(buildingAddress)\n      this.customer.buildingId = buildingId || null\n      this.customer.postCode = buildingAddressComponents.postCode\n      this.customer.uniqueCode = `${getBuildingUniqueCode(buildingAddressComponents)}.0}`\n\n      this.buildingData = {\n        buildingId,\n        buildingAddress: normalizeAddress(buildingAddress),\n        buildingAddressComponents,\n        buildingManagement,\n        buildingOwner,\n        buildingStatus\n      }\n    }\n  },\n  beforeDestroy () {\n    this.$root.$off('customer-data-received', this.getCustomerEventHandler)\n    this.$root.$off('building-data-received', this.getBuildingEventHandler)\n  },\n  mounted () {\n    console.log('CUSTOMER DETAILS MOUNTED')\n    console.log('CUSTOMER ID: ', this.customerId)\n    console.log('INITIAL ADDRESS DATA:\\n', this.initialAddressData)\n\n    if (this.customerId) {\n      this.$root.$on('customer-data-received', this.getCustomerEventHandler)\n      this.$root.$on('building-data-received', this.getBuildingEventHandler)\n      this.__getCustomerData(this.customerId)\n    } else {\n      if (!this.initialAddressData) return console.warn('Error: prop \"initialAddressData\" not defined')\n      this.buildingData = JSON.parse(JSON.stringify(this.initialAddressData))\n      this.createNewCustomer()\n      this.ready = true\n    }\n\n    // this.$root.$on('customer-updated', this.$emit('update:dialog', false))\n    // this.__getServices()\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CustomerDetails.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CustomerDetails.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CustomerDetails.vue?vue&type=template&id=ad9b76f2&\"\nimport script from \"./CustomerDetails.vue?vue&type=script&lang=js&\"\nexport * from \"./CustomerDetails.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VBtn,VCard,VIcon,VRow,VSpacer,VToolbar})\n"],"sourceRoot":""}